var loginSignup=function(e){"use strict";const t={Accept:"application/vnd.lichess.v5+json"},n={cache:"no-cache",credentials:"same-origin"},s={"X-Requested-With":"XMLHttpRequest"};return e.loginStart=function(){const e=".auth-login form";!function t(){const o=document.querySelector(e),i=$(o);o.addEventListener("submit",(a=>{a.preventDefault(),i.find(".submit").prop("disabled",!0),fetch(o.action,Object.assign(Object.assign({},n),{headers:s,method:"post",body:new FormData(o)})).then((e=>e.text().then((t=>[e,t])))).then((([n,s])=>{if("MissingTotpToken"===s||"InvalidTotpToken"===s)i.find(".one-factor").hide(),i.find(".two-factor").removeClass("none"),requestAnimationFrame((()=>i.find(".two-factor input").val("")[0].focus())),i.find(".submit").prop("disabled",!1),"InvalidTotpToken"===s&&i.find(".two-factor .error").removeClass("none");else if(n.ok)location.href=s.startsWith("ok:")?s.substr(3):"/";else try{const o=$(s).find(e);o.length?(i.replaceWith(o),t()):(alert(s||n.statusText+". Please wait some time before trying again."),i.find(".submit").prop("disabled",!1))}catch(e){console.warn(e),i.html(s)}}))}))}()},e.signupStart=function(){const e=$("#signup-form"),o=e.find(".username-exists"),i=e.find('input[name="username"]').on("change keyup paste",(()=>{o.hide(),a()})),a=function(e,t,n=!1){let s,o=0;return function(...i){const a=this;s&&clearTimeout(s),s=void 0;const r=performance.now()-o;o=performance.now(),n&&r>t?e.apply(a,i):s=setTimeout((()=>{s=void 0,e.apply(a,i)}),t)}}((()=>{const e=i.val();e.length>=3&&((e,o={})=>fetch(e,Object.assign(Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign({},t),s)}),o)).then((e=>{if(e.ok)return e.json();throw e.statusText})))(((e,t)=>{const n=new URLSearchParams;for(const e of Object.keys(t))void 0!==t[e]&&n.append(e,t[e]);const s=n.toString();return s?`${e}?${s}`:e})("/player/autocomplete",{term:e,exists:1})).then((e=>o.toggle(e)))}),300);e.on("submit",(()=>{if(!e.find('[name="h-captcha-response"]').val()&&e.hasClass("h-captcha-enabled"))return!1;e.find("button.submit").prop("disabled",!0).removeAttr("data-icon").addClass("frameless").html('<div class="spinner"><svg viewBox="0 0 40 40"><circle cx=20 cy=20 r=18 fill="none"></circle></svg></div>')})),window.signupSubmit=()=>{const e=document.getElementById("signup-form");e.reportValidity()&&e.submit()},lichess.loadModule("passwordComplexity").then((()=>window.passwordComplexity.addPasswordChangeListener("form3-password")))},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
