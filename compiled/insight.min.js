var LichessInsight=function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}function n(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var r=t((function(e){var t=function e(t,n){function r(e){return"function"==typeof e}function i(e){return"[object Object]"===d.call(e)}function o(e){return"[object String]"===d.call(e)}var a,l,u,s,c=Array.isArray||function(e){return"[object Array]"===d.call(e)},d={}.toString,f=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,h=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,m=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,p=function(){};function v(e){a=e.document,l=e.location,s=e.cancelAnimationFrame||e.clearTimeout,u=e.requestAnimationFrame||e.setTimeout}function g(e,t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(i(e))return W(e,n);var a,l=null!=t&&i(t)&&!("tag"in t||"view"in t||"subtree"in t),u=l?t:{},s="class"in u?"class":"className",d={tag:"div",attrs:{}},m=[];if(!o(e))throw new Error("selector in m(selector, attrs, children) should be a string");for(;null!=(a=f.exec(e));)if(""===a[1]&&a[2])d.tag=a[2];else if("#"===a[1])d.attrs.id=a[2];else if("."===a[1])m.push(a[2]);else if("["===a[3][0]){var p=h.exec(a[3]);d.attrs[p[1]]=p[3]||!p[2]||""}var v=l?n.slice(1):n;for(var g in 1===v.length&&c(v[0])?d.children=v[0]:d.children=v,u)u.hasOwnProperty(g)&&(g===s&&null!=u[g]&&""!==u[g]?(m.push(u[g]),d.attrs[g]=""):d.attrs[g]=u[g]);return m.length&&(d.attrs[s]=m.join(" ")),d}function y(e,t){for(var n=0;n<e.length&&!t(e[n],n++););}function b(e,t){y(e,(function(e,n){return(e=e&&e.attrs)&&null!=e.key&&t(e,n)}))}function w(e,t,n){e.insertBefore(t,e.childNodes[n]||null)}v(t),g.version=function(){return"v0.2.1-lila"};function x(e,t,n,r){var i=e.length!==t.length;return i||b(e,(function(e,n){var r=t[n];return i=r&&r.attrs&&r.attrs.key!==e.key})),i?function(e,t,n,r){b(e,(function(e,r){t[e=e.key]=t[e]?{action:3,index:r,from:t[e].index,element:n.nodes[t[e].index]||a.createElement("div")}:{action:2,index:r}}));var i=[];for(var o in t)i.push(t[o]);var l=i.sort(N),u=new Array(n.length);return u.nodes=n.nodes.slice(),y(l,(function(t){var i=t.index;if(1===t.action&&(_(n[i].nodes,n[i]),u.splice(i,1)),2===t.action){var o=a.createElement("div");o.key=e[i].attrs.key,w(r,o,i),u.splice(i,0,{attrs:{key:e[i].attrs.key},nodes:[o]}),u.nodes[i]=o}if(3===t.action){var l=t.element,s=r.childNodes[i];s!==l&&null!==l&&r.insertBefore(l,s||null),u[i]=n[t.from],u.nodes[i]=l}})),u}(e,n,t,r):t}function k(e,t,n,r,i,o){var l=t.nodes;return r&&r===a.activeElement||(e.$trusted?(_(l,t),l=B(n,i,e)):"textarea"===o?n.value=e:r?r.innerHTML=e:((1===l[0].nodeType||l.length>1)&&(_(t.nodes,t),l=[a.createTextNode(e)]),function(e,t,n,r){try{w(e,t,n),t.nodeValue=r}catch(e){}}(n,l[0],i,e))),(t=new e.constructor(e)).nodes=l,t}function C(e,t,n,r,i,o,l){return 0===e.nodes.length?function(e,t,n){var r;e.$trusted?r=B(t,n,e):(r=[a.createTextNode(e)],t.nodeName.match(m)||w(t,r[0],n));var i="string"==typeof e||"number"==typeof e||"boolean"==typeof e?new e.constructor(e):e;return i.nodes=r,i}(t,r,n):e.valueOf()!==t.valueOf()||!0===i?k(t,e,r,o,n,l):(e.nodes.intact=!0,e)}function O(e){if(e.$trusted){var t=e.match(/<[^\/]|\>\s*[^<]/g);if(null!=t)return t.length}else if(c(e))return e.length;return 1}function E(e,t,r,i,o,a,l,u,s){e=function(e){for(var t=0;t<e.length;t++)c(e[t])&&(e=e.concat.apply([],e),t--);return e}(e);var d=t.length===e.length,f=0,h={},m=!1;b(t,(function(e,n){m=!0,h[t[n].attrs.key]={action:1,index:n}})),function(e){var t=0;b(e,(function(){return y(e,(function(e){(e=e&&e.attrs)&&null==e.key&&(e.key="__mithril__"+t++)})),1}))}(e),m&&(t=x(e,t,h,r));for(var p=0,v=0,g=e.length;v<g;v++){var w=L(r,o,t,i,e[v],t[p],a,i+f||f,l,u,s);w!==n&&(d=d&&w.nodes.intact,f+=O(w),t[p++]=w)}return d||function(e,t,n){y(e,(function(e,r){null!=t[r]&&n.push.apply(n,t[r].nodes)})),y(t.nodes,(function(e,r){null!=e.parentNode&&n.indexOf(e)<0&&_([e],[t[r]])})),e.length<t.length&&(t.length=e.length),t.nodes=n}(e,t,[]),t}function T(e,t,n,r,i,o,a){var l={tag:e.tag,attrs:t,children:n,nodes:[r]};return function(e,t,n){n.length&&(e.views=t,e.controllers=n,y(n,(function(e){if(e.onunload&&e.onunload.$old&&(e.onunload=e.onunload.$old),ne&&e.onunload){var t=e.onunload;e.onunload=p,e.onunload.$old=t}})))}(l,o,a),l.children&&!l.children.nodes&&(l.children.nodes=[]),"select"===e.tag&&"value"in e.attrs&&j(r,e.tag,{value:e.attrs.value},{},i),l}function S(e,t,n,r,i,o){var a=function(e,t,n,r){var i="diff"===g.redraw.strategy()&&e?e.indexOf(t):-1;return i>-1?n[i]:"function"==typeof r?new r:{}}(n.views,t,r,e.controller),l=+(e&&e.attrs&&e.attrs.key);return"retain"===(e=0===ne||ee||r&&r.indexOf(a)>-1?e.view(a):{tag:"placeholder"}).subtree?n:(l==l&&((e.attrs=e.attrs||{}).key=l),function(e,t,n,r){null!=r.onunload&&V.push({controller:r,handler:r.onunload}),e.push(n),t.push(r)}(o,i,t,a),e)}function M(e,t,i,l,u,s,c,d){var f=[],h=[];if(!(e=function(e,t,n,r){for(var i=t&&t.controllers;null!=e.view;)e=S(e,e.view.$original||e.view,t,i,r,n);return e}(e,t,f,h)).tag&&h.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");e.attrs=e.attrs||{},t.attrs=t.attrs||{};var m=Object.keys(e.attrs),v=m.length>("key"in e.attrs?1:0);if(function(e,t,n){(e.tag!==t.tag||n.sort().join()!==Object.keys(t.attrs).sort().join()||e.attrs.id!==t.attrs.id||e.attrs.key!==t.attrs.key||"all"===g.redraw.strategy()&&(!t.configContext||!0!==t.configContext.retain)||"diff"===g.redraw.strategy()&&t.configContext&&!1===t.configContext.retain)&&(t.nodes.length&&_(t.nodes),t.configContext&&r(t.configContext.onunload)&&t.configContext.onunload(),t.controllers&&y(t.controllers,(function(e){e.unload&&e.onunload({preventDefault:p})})))}(e,t,m),o(e.tag)){var b,x=0===t.nodes.length;if(c=function(e,t){return e.attrs.xmlns?e.attrs.xmlns:"svg"===e.tag?"http://www.w3.org/2000/svg":"math"===e.tag?"http://www.w3.org/1998/Math/MathML":t}(e,c),x)t=T(e,function(e,t,n,r){return r?j(t,e.tag,e.attrs,{},n):e.attrs}(e,b=function(e,t){return t===n?e.attrs.is?a.createElement(e.tag,e.attrs.is):a.createElement(e.tag):e.attrs.is?a.createElementNS(t,e.tag,e.attrs.is):a.createElementNS(t,e.tag)}(e,c),c,v),function(e,t,r,i,o,a){return null!=e.children&&e.children.length>0?L(t,e.tag,n,n,e.children,r.children,!0,0,e.attrs.contenteditable?t:i,o,a):e.children}(e,b,t,i,c,d),b,c,f,h);else b=function(e,t,r,i,o,a,l,u){var s=e.nodes[0];return i&&j(s,t.tag,t.attrs,e.attrs,o),e.children=L(s,t.tag,n,n,t.children,e.children,!1,0,t.attrs.contenteditable?s:r,o,l),e.nodes.intact=!0,u.length&&(e.views=a,e.controllers=u),s}(t,e,i,v,c,f,d,h);return(x||!0===s&&null!=b)&&w(l,b,u),function(e,t,n,i,o){if(r(t.attrs.config)){var a=o.configContext=o.configContext||{};e.push((function(){return t.attrs.config.call(t,n,!i,a,o)}))}}(d,e,b,x,t),t}}function L(e,t,n,o,a,l,u,s,f,h,m){return"retain"===(a=function(e){return null==e?"":"object"==typeof e?e:null==e.toString()?"":e}(a)).subtree?l:(l=function(e,t,n,r,i){if(null!=t){if(d.call(t)===d.call(e))return t;if(i&&i.nodes){var o=n-r,a=o+(c(e)?e:t.nodes).length;_(i.nodes.slice(o,a),i.slice(o,a))}else t.nodes&&_(t.nodes,t)}return(t=new e.constructor).tag&&(t={}),t.nodes=[],t}(a,l,s,o,n),c(a)?E(a,l,e,s,t,u,f,h,m):null!=a&&i(a)?M(a,l,f,e,s,u,h,m):r(a)?l:C(l,a,s,e,u,f,t))}function N(e,t){return e.action-t.action||e.index-t.index}function j(e,t,n,o,a){for(var l in n){var u=n[l],s=o[l];if(l in o&&s===u)"value"===l&&"input"===t&&e.value!=u&&(e.value=u);else{if(o[l]=u,"config"===l||"key"===l)continue;if(r(u)&&"on"===l.slice(0,2))e[l]=z(u,e);else if("style"===l&&null!=u&&i(u)){for(var c in u)null!=s&&s[c]===u[c]||(e.style[c]=u[c]);for(var c in s)c in u||(e.style[c]="")}else null!=a?"href"===l?e.setAttributeNS("http://www.w3.org/1999/xlink","href",u):e.setAttribute("className"===l?"class":l,u):l in e&&"list"!==l&&"style"!==l&&"form"!==l&&"type"!==l&&"width"!==l&&"height"!==l?"input"===t&&e[l]===u||(e[l]=u):e.setAttribute(l,u)}}return o}function _(e,t){for(var n=e.length-1;n>-1;n--)if(e[n]&&e[n].parentNode){try{e[n].parentNode.removeChild(e[n])}catch(e){}(t=[].concat(t))[n]&&A(t[n])}e.length&&(e.length=0)}function A(e){e.configContext&&r(e.configContext.onunload)&&(e.configContext.onunload(),e.configContext.onunload=null),e.controllers&&y(e.controllers,(function(e){r(e.onunload)&&e.onunload({preventDefault:p})})),e.children&&(c(e.children)?y(e.children,A):e.children.tag&&A(e.children))}var $,F=function(){try{return a.createRange().createContextualFragment("x"),function(e,t){e.appendChild(a.createRange().createContextualFragment(t))}}catch(e){return function(e,t){e.insertAdjacentHTML("beforeend",t)}}}();function B(e,t,n){var r=e.childNodes[t];if(r){var i=1!==r.nodeType,o=a.createElement("span");i?(e.insertBefore(o,r||null),o.insertAdjacentHTML("beforebegin",n),e.removeChild(o)):r.insertAdjacentHTML("beforebegin",n)}else F(e,n);for(var l=[];e.childNodes[t]!==r;)l.push(e.childNodes[t]),t++;return l}function z(e,t){return function(n){n=n||event,g.redraw.strategy("diff"),g.startComputation();try{return e.call(t,n)}finally{re()}}}var R={appendChild:function(e){$===n&&($=a.createElement("html")),a.documentElement&&a.documentElement!==e?a.replaceChild(e,a.documentElement):a.appendChild(e),this.childNodes=a.childNodes},insertBefore:function(e){this.appendChild(e)},childNodes:[]},D=[],U={};function I(e){var t=D.indexOf(e);return t<0?D.push(e)-1:t}g.render=function(e,t,r){var i=[];if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o=I(e),l=e===a,u=l||e===a.documentElement?R:e;l&&"html"!==t.tag&&(t={tag:"html",attrs:{},children:t}),U[o]===n&&_(u.childNodes),!0===r&&pe(e),U[o]=L(u,null,n,n,t,U[o],!1,0,null,n,i),y(i,(function(e){e()}))},g.trust=function(e){return(e=new String(e)).$trusted=!0,e},g.prop=function(e){return(null!=e&&i(e)||r(e))&&r(e.then)?ve(e):function(e){var t=function(){return arguments.length&&(e=arguments[0]),e};return t.toJSON=function(){return e},t}(e)};var G,H=[],P=[],q=[],K=null,Y=0,J=null,Q=null,V=[];function W(e,t){var n=function(){return(e.controller||p).apply(this,t)||this};e.controller&&(n.prototype=e.controller.prototype);var r=function(n){var r=arguments.length>1?t.concat([].slice.call(arguments,1)):t;return e.view.apply(e,r?[n].concat(r):[n])};r.$original=e.view;var i={controller:n,view:r};return t[0]&&null!=t[0].key&&(i.attrs={key:t[0].key}),i}function Z(e,t){H.splice(t,1),q.splice(t,1),P.splice(t,1),pe(e),D.splice(I(e),1)}g.component=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);return W(e,t)},g.mount=g.module=function(e,t){if(!e)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var n=H.indexOf(e);n<0&&(n=H.length);var i=!1,o={preventDefault:function(){i=!0,J=Q=null}};y(V,(function(e){e.handler.call(e.controller,o),e.controller.onunload=null})),i?y(V,(function(e){e.controller.onunload=e.handler})):V=[],q[n]&&r(q[n].onunload)&&q[n].onunload(o);var a=null===t;if(!i){g.redraw.strategy("all"),g.startComputation(),H[n]=e;var l=G=t||(t={controller:p}),u=new(t.controller||p);return l===G&&(q[n]=u,P[n]=t),re(),a&&Z(e,n),q[n]}a&&Z(e,n)};var X=!1,ee=!1;function te(){J&&(J(),J=null),y(H,(function(e,t){var n=P[t];if(q[t]){var r=[q[t]];g.render(e,n.view?n.view(q[t],r):"")}})),Q&&(Q(),Q=null),K=null,Y=new Date,g.redraw.strategy("diff")}g.redraw=function(e){if(!X){X=!0,e&&(ee=!0);try{K&&!e?(u===t.requestAnimationFrame||new Date-Y>16)&&(K>0&&s(K),K=u(te,16)):(te(),K=u((function(){K=null}),16))}finally{X=ee=!1}}},g.redraw.strategy=g.prop();var ne=0;function re(){"none"===g.redraw.strategy()?(ne--,g.redraw.strategy("diff")):g.endComputation()}g.startComputation=function(){ne++},g.endComputation=function(){ne>1?ne--:(ne=0,g.redraw())},g.withAttr=function(e,t,n){return function(r){var i=(r=r||event).currentTarget||this,o=n||this;t.call(o,e in i?i[e]:i.getAttribute(e))}};var ie,oe,ae={pathname:"",hash:"#",search:"?"},le=p,ue=!1;function se(e){return e.slice(ae[g.route.mode].length)}function ce(e,t,n){ie={};var r=n.indexOf("?");-1!==r&&(ie=me(n.substr(r+1,n.length)),n=n.substr(0,r));var i=Object.keys(t),o=i.indexOf(n);if(-1!==o)return g.mount(e,t[i[o]]),!0;for(var a in t){if(a===n)return g.mount(e,t[a]),!0;var l=new RegExp("^"+a.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(l.test(n))return n.replace(l,(function(){var n=a.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2);y(n,(function(e,t){ie[e.replace(/:|\./g,"")]=decodeURIComponent(r[t])})),g.mount(e,t[a])})),!0}}function de(e){if(!(e=e||event).ctrlKey&&!e.metaKey&&2!==e.which){e.preventDefault?e.preventDefault():e.returnValue=!1;for(var t=e.currentTarget||e.srcElement,n="pathname"===g.route.mode&&t.search?me(t.search.slice(1)):{};t&&"A"!==t.nodeName.toUpperCase();)t=t.parentNode;g.route(t[g.route.mode].slice(ae[g.route.mode].length),n)}}function fe(){"hash"!==g.route.mode&&l.hash?l.hash=l.hash:t.scrollTo(0,0)}function he(e,t){var r={},o=[];for(var a in e){var l=t?t+"["+a+"]":a,u=e[a];if(null===u)o.push(encodeURIComponent(l));else if(i(u))o.push(he(u,l));else if(c(u)){var s=[];r[l]=r[l]||{},y(u,(function(e){r[l][e]||(r[l][e]=!0,s.push(encodeURIComponent(l)+"="+encodeURIComponent(e)))})),o.push(s.join("&"))}else u!==n&&o.push(encodeURIComponent(l)+"="+encodeURIComponent(u))}return o.join("&")}function me(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));var t=e.split("&"),n={};return y(t,(function(e){var t=e.split("="),r=decodeURIComponent(t[0]),i=2===t.length?decodeURIComponent(t[1]):null;null!=n[r]?(c(n[r])||(n[r]=[n[r]]),n[r].push(i)):n[r]=i})),n}function pe(e){var t=I(e);_(e.childNodes,U[t]),U[t]=n}function ve(e,t){var n=g.prop(t);return e.then(n),n.then=function(n,r){return ve(e.then(n,r),t)},n.catch=n.then.bind(null,null),n.finally=function(e){var r=function(){return g.deferred().resolve(e()).promise};return n.then((function(e){return ve(r().then((function(){return e})),t)}),(function(e){return ve(r().then((function(){throw new Error(e)})),t)}))},n}function ge(e,t){var n=this,o=0,a=0,l=[];function u(e){o=e||4,l.map((function(e){3===o?e.resolve(a):e.reject(a)}))}function s(e,t,n,o){if((null!=a&&i(a)||r(a))&&r(e))try{var l=0;e.call(a,(function(e){l++||(a=e,t())}),(function(e){l++||(a=e,n())}))}catch(e){g.deferred.onerror(e),a=e,n()}else o()}function c(){var i;try{i=a&&a.then}catch(e){return g.deferred.onerror(e),a=e,o=2,c()}s(i,(function(){o=1,c()}),(function(){o=2,c()}),(function(){try{1===o&&r(e)?a=e(a):2===o&&r(t)&&(a=t(a),o=1)}catch(e){return g.deferred.onerror(e),a=e,u()}a===n?(a=TypeError(),u()):s(i,(function(){u(3)}),u,(function(){u(1===o&&3)}))}))}n.promise={},n.resolve=function(e){return o||(a=e,o=1,c()),this},n.reject=function(e){return o||(a=e,o=2,c()),this},n.promise.then=function(e,t){var n=new ge(e,t);return 3===o?n.resolve(a):4===o?n.reject(a):l.push(n),n.promise}}function ye(e){return e}return g.route=function(e,n,r,i){if(0===arguments.length)return oe;if(3===arguments.length&&o(n)){le=function(t){var i=oe=se(t);if(!ce(e,r,i)){if(ue)throw new Error("Ensure the default route matches one of the routes defined in m.route");ue=!0,g.route(n,!0),ue=!1}};var u="hash"===g.route.mode?"onhashchange":"onpopstate";t[u]=function(){var e=l[g.route.mode];"pathname"===g.route.mode&&(e+=l.search),oe!==se(e)&&le(e)},J=fe,t[u]()}else if(e.addEventListener||e.attachEvent)e.href=("pathname"!==g.route.mode?l.pathname:"")+ae[g.route.mode]+i.attrs.href,e.addEventListener?(e.removeEventListener("click",de),e.addEventListener("click",de)):(e.detachEvent("onclick",de),e.attachEvent("onclick",de));else if(o(e)){var s=oe,c=n||{},d=(oe=e).indexOf("?"),f=d>-1?me(oe.slice(d+1)):{};for(var h in c)f[h]=c[h];var m=he(f),p=d>-1?oe.slice(0,d):oe;m&&(oe=p+(-1===p.indexOf("?")?"?":"&")+m);var v=!0===(3===arguments.length?r:n)||s===e;t.history.pushState?(J=fe,Q=function(){t.history[v?"replaceState":"pushState"](null,a.title,ae[g.route.mode]+oe)},le(ae[g.route.mode]+oe)):(l[g.route.mode]=oe,le(ae[g.route.mode]+oe))}},g.route.param=function(e){if(!ie)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return e?ie[e]:ie},g.route.mode="search",g.route.buildQueryString=he,g.route.parseQueryString=me,g.deferred=function(){var e=new ge;return e.promise=ve(e.promise),e},g.deferred.onerror=function(e){if("[object Error]"===d.call(e)&&!e.constructor.toString().match(/ Error/))throw ne=0,e},g.sync=function(e){var t="resolve";function n(e,n){return function(a){return o[e]=a,n||(t="reject"),0==--i&&(r.promise(o),r[t](o)),a}}var r=g.deferred(),i=e.length,o=new Array(i);return e.length>0?y(e,(function(e,t){e.then(n(t,!0),n(t,!1))})):r.resolve([]),r.promise},g.request=function(e){!0!==e.background&&g.startComputation();var i,l,u,s=new ge,d=e.dataType&&"jsonp"===e.dataType.toLowerCase(),f=e.serialize=d?ye:e.serialize||JSON.stringify,h=e.deserialize=d?ye:e.deserialize||JSON.parse,m=d?function(e){return e.responseText}:e.extract||function(e){return 0===e.responseText.length&&h===JSON.parse?null:e.responseText};return e.method=(e.method||"GET").toUpperCase(),e.url=(i=e.url,l=e.data,(u=i.match(/:[a-z]\w+/gi))&&l&&y(u,(function(e){var t=e.slice(1);i=i.replace(e,l[t]),delete l[t]})),i),(e=function(e,t,n){if("GET"===e.method&&"jsonp"!==e.dataType){var r=e.url.indexOf("?")<0?"?":"&",i=he(t);e.url=e.url+(i?r+i:"")}else e.data=n(t);return e}(e,e.data,f)).onload=e.onerror=function(t){try{var n=(("load"===(t=t||event).type?e.unwrapSuccess:e.unwrapError)||ye)(h(m(t.target,e)),t.target);"load"===t.type&&(c(n)&&e.type?y(n,(function(t,r){n[r]=new e.type(t)})):e.type&&(n=new e.type(n))),s["load"===t.type?"resolve":"reject"](n)}catch(t){g.deferred.onerror(t),s.reject(t)}!0!==e.background&&g.endComputation()},function(e){if(!e.dataType||"jsonp"!==e.dataType.toLowerCase()){var i=new t.XMLHttpRequest;if(i.open(e.method,e.url,!0,e.user,e.password),i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300?e.onload({type:"load",target:i}):e.onerror({type:"error",target:i}))},e.serialize===JSON.stringify&&e.data&&"GET"!==e.method&&i.setRequestHeader("Content-Type","application/json; charset=utf-8"),e.deserialize===JSON.parse&&i.setRequestHeader("Accept","application/json, text/*"),r(e.config)){var l=e.config(i,e);null!=l&&(i=l)}var u="GET"!==e.method&&e.data?e.data:"";if(u&&!o(u)&&u.constructor!==t.FormData)throw new Error("Request data should be either be a string or FormData. Check the `serialize` option in `m.request`");return i.send(u),i}var s="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),c=a.createElement("script");t[s]=function(r){c.parentNode.removeChild(c),e.onload({type:"load",target:{responseText:r}}),t[s]=n},c.onerror=function(){return c.parentNode.removeChild(c),e.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),t[s]=n,!1},c.onload=function(){return!1},c.src=e.url+(e.url.indexOf("?")>0?"&":"?")+(e.callbackKey?e.callbackKey:"callback")+"="+s+"&"+he(e.data||{}),a.body.appendChild(c)}(e),s.promise=ve(s.promise,e.initialValue),s.promise},g.deps=function(e){return v(t=e||t),t},g.deps.factory=e,g}("undefined"!=typeof window?window:{});null!=e&&e.exports&&(e.exports=t)}));var i=n(Object.freeze({__proto__:null,default:function(e,t){let n,r=0;return function(...i){const o=this,a=performance.now()-r;function l(){n=void 0,r=performance.now(),t.apply(o,i)}n&&clearTimeout(n),a>e?l():n=setTimeout(l,e-a)}}})).default,o=function(e,t){this.ui=e.ui,this.user=e.user,this.own=e.myUserId===this.user.id,this.dimensions=[].concat.apply([],this.ui.dimensionCategs.map((function(e){return e.items}))),this.metrics=[].concat.apply([],this.ui.metricCategs.map((function(e){return e.items})));var n=function(e){return this.metrics.find((function(t){return t.key===e}))}.bind(this),o=function(e){return this.dimensions.find((function(t){return t.key===e}))}.bind(this);this.vm={metric:n(e.initialQuestion.metric),dimension:o(e.initialQuestion.dimension),filters:e.initialQuestion.filters,loading:!0,broken:!1,answer:null,panel:Object.keys(e.initialQuestion.filters).length?"filter":"preset"},this.setPanel=function(e){this.vm.panel=e,r.redraw()}.bind(this);var a=function(){this.vm.metric=this.metrics[0],this.vm.dimension=this.dimensions[0],this.vm.filters={}}.bind(this),l=i(1e3,function(){this.validCombinationCurrent()||a(),this.pushState(),this.vm.loading=!0,this.vm.broken=!1,r.redraw(),setTimeout(function(){r.request({method:"post",url:e.postUrl,data:{metric:this.vm.metric.key,dimension:this.vm.dimension.key,filters:this.vm.filters},deserialize:function(e){try{return JSON.parse(e)}catch(t){throw new Error(e)}}}).then(function(e){this.vm.answer=e,this.vm.loading=!1}.bind(this),function(){this.vm.loading=!1,this.vm.broken=!0,r.redraw()}.bind(this))}.bind(this),1)}.bind(this));this.makeUrl=function(t,n,r){var i=[e.pageUrl,n,t].join("/");return(r=Object.keys(r).map((function(e){return e+":"+r[e].join(",")})).join("/")).length&&(i+="/"+r),i},this.makeCurrentUrl=function(){return this.makeUrl(this.vm.dimension.key,this.vm.metric.key,this.vm.filters)}.bind(this),this.pushState=function(){history.replaceState({},null,this.makeCurrentUrl())}.bind(this),this.validCombination=function(e,t){return e&&t&&("game"===e.position||"move"===t.position)},this.validCombinationCurrent=function(){return this.validCombination(this.vm.dimension,this.vm.metric)}.bind(this),this.setMetric=function(e){this.vm.metric=n(e),this.validCombinationCurrent()||(this.vm.dimension=this.dimensions.find(function(e){return this.validCombination(e,this.vm.metric)}.bind(this))),this.vm.panel="filter",l()}.bind(this),this.setDimension=function(e){this.vm.dimension=o(e),this.validCombinationCurrent()||(this.vm.metric=this.metrics.find(function(e){return this.validCombination(this.vm.dimension,e)}.bind(this))),this.vm.panel="filter",l()}.bind(this),this.setFilter=function(e,t){t.length?this.vm.filters[e]=t:delete this.vm.filters[e],l()}.bind(this),this.setQuestion=function(e){this.vm.dimension=o(e.dimension),this.vm.metric=n(e.metric),this.vm.filters=e.filters,l(),$(t).find("select.ms").multipleSelect("open"),setTimeout((function(){$(t).find("select.ms").multipleSelect("close")}),1e3)}.bind(this),this.clearFilters=function(){Object.keys(this.vm.filters).length&&(this.vm.filters={},l())}.bind(this),l()},a=function(e){return r("div.axis-form",[r("select.ms.metric",{multiple:!0,config:function(t,n){$(t).multipleSelect({width:"200px",maxHeight:"400px",single:!0,onClick:function(t){e.setMetric(t.value)}})}},e.ui.metricCategs.map((function(t){return r("optgroup",{label:t.name},t.items.map((function(t){return r("option",{title:t.description.replace(/<a[^>]*>[^>]+<\/a[^>]*>/,""),value:t.key,selected:e.vm.metric.key===t.key},t.name)})))}))),r("span.by","by"),r("select.ms.dimension",{multiple:!0,config:function(t,n){$(t).multipleSelect({width:"200px",maxHeight:"400px",single:!0,onClick:function(t){e.setDimension(t.value)}})}},e.ui.dimensionCategs.map((function(t){return r("optgroup",{label:t.name},t.items.map((function(t){if("period"!==t.key)return r("option",{title:t.description.replace(/<a[^>]*>[^>]+<\/a[^>]*>/,""),value:t.key,selected:e.vm.dimension.key===t.key},t.name)})))})))])};function l(e){return function(t){if("date"!==t.key){var n="period"===t.key;return r("select",{multiple:!0,config:function(r,i){i&&e.vm.filters[t.key]||$(r).multipleSelect({placeholder:t.name,width:"100%",selectAll:!1,filter:"opening"===t.key,single:n,minimumCountSelected:10,onClick:function(i){var o=n?[i.value]:$(r).multipleSelect("getSelects");e.setFilter(t.key,o)}})}},t.values.map((function(n){var i=e.vm.filters[t.key];return r("option",{value:n.key,selected:i&&i.includes(n.key)},n.name)})))}}}var u=function(e){return r("div.filters",[r("div.items",e.ui.dimensionCategs.map((function(t){return r("div.categ.box",[r("div.top",t.name),t.items.map(l(e))])})))])},s=function(e){return r("div.box.presets",e.ui.presets.map((function(t){var n=e.makeUrl(t.dimension,t.metric,t.filters)===e.makeCurrentUrl();return r("a",{class:"preset text"+(n?" active":""),"data-icon":"7",onclick:function(){e.setQuestion(t)}},t.name)})))};function c(e){return"seconds"===e?"{point.y:.1f}":"average"===e?"{point.y:,.1f}":"percent"===e?"{point.y:.1f}%":"{point.y:,.0f}"}function d(e){return"seconds"===e?"{value:.1f}":"average"===e?"{value:,.1f}":"percent"===e?"{value:.0f}%":"{value:,.0f}"}var f,h,m={Victory:"#759900",Draw:"#007599",Defeat:"#dc322f"},p=(f=$("body").hasClass("light"),h={light:f,text:{weak:f?"#808080":"#9a9a9a",strong:f?"#505050":"#c0c0c0"},line:{weak:f?"#ccc":"#404040",strong:f?"#a0a0a0":"#606060",fat:"#d85000"}},f||(h.colors=["#2b908f","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"]),h);function v(e){return r("div.chart.empty",[r("i[data-icon=7]"),e])}var g=function(e){return e.validCombinationCurrent()?e.vm.answer.series.length?[r("div.chart",{config:function(t){e.vm.loading||function(e,t){var n,r={name:t.sizeSerie.name,data:t.sizeSerie.data,yAxis:1,type:"column",stack:"size",animation:{duration:300},color:"rgba(120,120,120,0.2)"},i=t.series.map((function(e){var n={name:e.name,data:e.data,yAxis:0,type:"column",stack:e.stack,dataLabels:{enabled:!0,format:e.stack?"{point.percentage:.0f}%":c(e.dataType)},tooltip:{pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>'+c(e.dataType)+"</b><br/>",shared:!0}};return"Game result"===t.valueYaxis.name&&(n.color=m[e.name]),n})),o={chart:{type:"column",alignTicks:"percent"!==t.valueYaxis.dataType,spacing:[20,7,20,5],backgroundColor:null,borderWidth:0,borderRadius:0,plotBackgroundColor:null,plotShadow:!1,plotBorderWidth:0,style:{font:"12px 'Noto Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif"}},title:{text:null},xAxis:{type:"date"===t.xAxis.dataType?"datetime":"linear",categories:t.xAxis.categories.map((function(e){return"date"===t.xAxis.dataType?1e3*e:e})),crosshair:!0,labels:{format:(n=t.xAxis.dataType,"date"===n?"{value:%Y-%m-%d}":"{value}"),style:{color:p.text.weak,fontSize:9}},title:{style:{color:p.text.weak,fontSize:9}},gridLineColor:p.line.weak,lineColor:p.line.strong,tickColor:p.line.strong},yAxis:[t.valueYaxis,t.sizeYaxis].map((function(e,n){var r="percent"===t.valueYaxis.dataType,i=n%2==1,o={opposite:i,min:!i&&r?0:void 0,max:!i&&r?100:void 0,labels:{format:d(e.dataType),style:{color:p.text.weak,fontSize:9}},title:{text:1===n&&e.name,style:{color:p.text.weak,fontSize:9}},gridLineColor:p.line.weak};return i&&r&&(o.minorGridLineWidth=0,o.gridLineWidth=0,o.alternateGridColor=null),o})),plotOptions:{column:{animation:{duration:300},stacking:"normal",dataLabels:{color:p.text.strong},marker:{lineColor:p.text.weak},borderColor:p.line.strong}},series:i.concat(r),credits:{enabled:!1},labels:{style:{color:p.text.strong}},tooltip:{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:p.light?[[0,"rgba(200, 200, 200, .8)"],[1,"rgba(250, 250, 250, .8)"]]:[[0,"rgba(56, 56, 56, .8)"],[1,"rgba(16, 16, 16, .8)"]]},style:{fontWeight:"bold",color:p.text.strong}},legend:{enabled:!0,itemStyle:{color:p.text.weak},itemHiddenStyle:{color:p.text.weak}}};p.colors&&(o.colors=p.colors),Highcharts.chart(e,o)}(t,e.vm.answer)}}),e.vm.loading?r.trust(lichess.spinnerHtml):null]:v("No data. Try widening or clearing the filters."):v("Invalid dimension/metric combination")},y=t((function(t){(function(){var e,n={},r={currentLanguage:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0"},i={currentLanguage:r.currentLanguage,zeroFormat:r.zeroFormat,nullFormat:r.nullFormat,defaultFormat:r.defaultFormat},o={bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],iec:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]};function a(e){this._value=e}function l(e,t,n,r){var i,o,a,l,u=e.toString().split("."),s=t-(r||0);return i=2===u.length?Math.min(Math.max(u[1].length,s),t):s,l=(n(e*(a=Math.pow(10,i)))/a).toFixed(i),r>t-i&&(o=new RegExp("\\.?0{1,"+(r-(t-i))+"}$"),l=l.replace(o,"")),l}function u(e,t,r){return 0===e._value&&null!==i.zeroFormat?i.zeroFormat:null===e._value&&null!==i.nullFormat?i.nullFormat:t.indexOf("$")>-1?function(e,t,r){var o,a,l=t.indexOf("$"),u=t.indexOf("("),c=t.indexOf("-"),d="";t.indexOf(" $")>-1?(d=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(d=" ",t=t.replace("$ ","")):t=t.replace("$","");a=s(e._value,t,r),l<=1?a.indexOf("(")>-1||a.indexOf("-")>-1?(o=1,(l<u||l<c)&&(o=0),(a=a.split("")).splice(o,0,n[i.currentLanguage].currency.symbol+d),a=a.join("")):a=n[i.currentLanguage].currency.symbol+d+a:a.indexOf(")")>-1?((a=a.split("")).splice(-1,0,d+n[i.currentLanguage].currency.symbol),a=a.join("")):a=a+d+n[i.currentLanguage].currency.symbol;return a}(e,t,r):t.indexOf("%")>-1?function(e,t,n){var r,i="",o=100*e._value;t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%","");(r=s(o,t,n)).indexOf(")")>-1?((r=r.split("")).splice(-1,0,i+"%"),r=r.join("")):r=r+i+"%";return r}(e,t,r):t.indexOf(":")>-1?function(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}(e):t.indexOf("b")>-1||t.indexOf("ib")>-1?function(e,t,n){var r,i,a,l=t.indexOf("ib")>-1?o.iec:o.bytes,u=e._value,c="";t.indexOf(" b")>-1||t.indexOf(" ib")>-1?(c=" ",t=t.replace(" ib","").replace(" b","")):t=t.replace("ib","").replace("b","");for(r=0;r<=l.length;r++)if(i=Math.pow(1024,r),a=Math.pow(1024,r+1),null===u||0===u||u>=i&&u<a){c+=l[r],i>0&&(u/=i);break}return s(u,t,n)+c}(e,t,r):t.indexOf("o")>-1?function(e,t,r){var o="";t.indexOf(" o")>-1?(o=" ",t=t.replace(" o","")):t=t.replace("o","");return o+=n[i.currentLanguage].ordinal(e._value),s(e._value,t,r)+o}(e,t,r):s(e._value,t,r)}function s(e,t,r){var o,a,u,s,c=!1,d=!1,f=!1,h="",m=!1,p=!1,v=!1,g=!1,y=!1,b="",w=!1;return null===e&&(e=0),o=Math.abs(e),t.indexOf("(")>-1?(c=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(d=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(m=t.indexOf("aK")>=0,p=t.indexOf("aM")>=0,v=t.indexOf("aB")>=0,g=t.indexOf("aT")>=0,y=m||p||v||g,t.indexOf(" a")>-1&&(h=" "),t=t.replace(new RegExp(h+"a[KMBT]?"),""),o>=Math.pow(10,12)&&!y||g?(h+=n[i.currentLanguage].abbreviations.trillion,e/=Math.pow(10,12)):o<Math.pow(10,12)&&o>=Math.pow(10,9)&&!y||v?(h+=n[i.currentLanguage].abbreviations.billion,e/=Math.pow(10,9)):o<Math.pow(10,9)&&o>=Math.pow(10,6)&&!y||p?(h+=n[i.currentLanguage].abbreviations.million,e/=Math.pow(10,6)):(o<Math.pow(10,6)&&o>=Math.pow(10,3)&&!y||m)&&(h+=n[i.currentLanguage].abbreviations.thousand,e/=Math.pow(10,3))),t.indexOf("[.]")>-1&&(f=!0,t=t.replace("[.]",".")),a=e.toString().split(".")[0],u=t.split(".")[1],s=t.indexOf(","),u?(a=(b=u.indexOf("[")>-1?l(e,(u=(u=u.replace("]","")).split("["))[0].length+u[1].length,r,u[1].length):l(e,u.length,r)).split(".")[0],b=b.indexOf(".")>-1?n[i.currentLanguage].delimiters.decimal+b.split(".")[1]:"",f&&0===Number(b.slice(1))&&(b="")):a=l(e,null,r),a.indexOf("-")>-1&&(a=a.slice(1),w=!0),s>-1&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[i.currentLanguage].delimiters.thousands)),0===t.indexOf(".")&&(a=""),(c&&w?"(":"")+(!c&&w?"-":"")+(!w&&d?"+":"")+a+b+(h||"")+(c&&w?")":"")}function c(e,t){var r,a,l,u,s,c,d=t,f=!1;if(t.indexOf(":")>-1)c=function(e){var t=e.split(":"),n=0;3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1]));return Number(n)}(t);else if(t===i.zeroFormat||t===i.nullFormat)c=0;else{for("."!==n[i.currentLanguage].delimiters.decimal&&(t=t.replace(/\./g,"").replace(n[i.currentLanguage].delimiters.decimal,".")),r=new RegExp("[^a-zA-Z]"+n[i.currentLanguage].abbreviations.thousand+"(?:\\)|(\\"+n[i.currentLanguage].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+n[i.currentLanguage].abbreviations.million+"(?:\\)|(\\"+n[i.currentLanguage].currency.symbol+")?(?:\\))?)?$"),l=new RegExp("[^a-zA-Z]"+n[i.currentLanguage].abbreviations.billion+"(?:\\)|(\\"+n[i.currentLanguage].currency.symbol+")?(?:\\))?)?$"),u=new RegExp("[^a-zA-Z]"+n[i.currentLanguage].abbreviations.trillion+"(?:\\)|(\\"+n[i.currentLanguage].currency.symbol+")?(?:\\))?)?$"),s=1;s<=o.bytes.length&&!(f=(t.indexOf(o.bytes[s])>-1||t.indexOf(o.iec[s])>-1)&&Math.pow(1024,s));s++);c=f||1,c*=d.match(r)?Math.pow(10,3):1,c*=d.match(a)?Math.pow(10,6):1,c*=d.match(l)?Math.pow(10,9):1,c*=d.match(u)?Math.pow(10,12):1,c*=t.indexOf("%")>-1?.01:1,c*=(t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1,c*=Number(t.replace(/[^0-9\.]+/g,"")),c=f?Math.ceil(c):c}return e._value=c,e._value}function d(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function f(){var e=Array.prototype.slice.call(arguments);return e.reduce((function(e,t){var n=d(e),r=d(t);return n>r?n:r}),-1/0)}(e=function(t){return new a(t=e.isNumeral(t)?t.value():0===t||void 0===t?0:null===t?null:Number(t)?Number(t):e.fn.unformat(t))}).version="1.5.6",e.isNumeral=function(e){return e instanceof a},e.language=function(t,r){if(!t)return i.currentLanguage;if((t=t.toLowerCase())&&!r){if(!n[t])throw new Error("Unknown language : "+t);i.currentLanguage=t}return!r&&n[t]||function(e,t){n[e]=t}(t,r),e},e.reset=function(){for(var e in r)i[e]=r[e]},e.languageData=function(e){if(!e)return n[i.currentLanguage];if(!n[e])throw new Error("Unknown language : "+e);return n[e]},e.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),e.zeroFormat=function(e){i.zeroFormat="string"==typeof e?e:null},e.nullFormat=function(e){i.nullFormat="string"==typeof e?e:null},e.defaultFormat=function(e){i.defaultFormat="string"==typeof e?e:"0.0"},e.validate=function(t,n){var r,i,o,a,l,u,s,c;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{s=e.languageData(n)}catch(t){s=e.languageData(e.language())}return o=s.currency.symbol,l=s.abbreviations,r=s.delimiters.decimal,i="."===s.delimiters.thousands?"\\.":s.delimiters.thousands,(null===(c=t.match(/^[^\d]+/))||(t=t.substr(1),c[0]===o))&&((null===(c=t.match(/[^\d]+$/))||(t=t.slice(0,-1),c[0]===l.thousand||c[0]===l.million||c[0]===l.billion||c[0]===l.trillion))&&(u=new RegExp(i+"{2}"),!t.match(/[^\d.,]/g)&&(!((a=t.split(r)).length>2)&&(a.length<2?!!a[0].match(/^\d+.*\d$/)&&!a[0].match(u):1===a[0].length?!!a[0].match(/^\d+$/)&&!a[0].match(u)&&!!a[1].match(/^\d+$/):!!a[0].match(/^\d+.*\d$/)&&!a[0].match(u)&&!!a[1].match(/^\d+$/)))))},Array.prototype.reduce||(Array.prototype.reduce=function(e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,n=Object(this),r=n.length>>>0,i=0;if(2===arguments.length)t=arguments[1];else{for(;i<r&&!(i in n);)i++;if(i>=r)throw new TypeError("Reduce of empty array with no initial value");t=n[i++]}for(;i<r;i++)i in n&&(t=e(t,n[i],i,n));return t}),e.fn=a.prototype={clone:function(){return e(this)},format:function(e,t){return u(this,e||i.defaultFormat,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:c(this,e||i.defaultFormat)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){var t=f.call(null,this._value,e);return this._value=[this._value,e].reduce((function(e,n,r,i){return e+t*n}),0)/t,this},subtract:function(e){var t=f.call(null,this._value,e);return this._value=[e].reduce((function(e,n,r,i){return e-t*n}),this._value*t)/t,this},multiply:function(e){return this._value=[this._value,e].reduce((function(e,t,n,r){var i=f(e,t);return e*i*(t*i)/(i*i)}),1),this},divide:function(e){return this._value=[this._value,e].reduce((function(e,t,n,r){var i=f(e,t);return e*i/(t*i)})),this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}},t.exports&&(t.exports=e),"undefined"==typeof ender&&(this.numeral=e)}).call(e)}));function b(e,t){var n;return"percent"===e&&(t/=100),n="seconds"===e||"average"===e?"0.00":"percent"===e?"0.0%":"0,0",y(t).format(n)}var w=function(e){var t=e.vm.answer;return t?r("table.slist",[r("thead",r("tr",[r("th",t.xAxis.name),t.series.map((function(e){return r("th",e.name)})),r("th",t.sizeYaxis.name)])),r("tbody",t.xAxis.categories.map((function(e,n){return r("tr",[r("th",(i=t.xAxis.dataType,o=e,"date"===i?new Date(1e3*o).toLocaleDateString():o)),t.series.map((function(e){return r("td.data",b(e.dataType,e.data[n]))})),r("td.size",b(t.sizeSerie.dataType,t.sizeSerie.data[n]))]);var i,o})))]):null},x=function(e){return r("div.help.box",[r("div.top","Definitions"),r("div.content",["metric","dimension"].map((function(t){var n=e.vm[t];return r("section."+t,[r("h3",n.name),r("p",r.trust(n.description))])})))])},k=["nobody","friends only","everybody"],C=function(e){var t="Shared with "+k[e.user.shareId]+".";return r("div.info.box",[r("div.top",[r("a.username.user-link.insight-ulpt",{href:"/@/"+e.user.name},e.user.name)]),r("div.content",[r("p",["Insights over ",r("strong",e.user.nbGames)," rated games."]),r("p.share",e.own?r("a",{href:"/account/preferences/privacy",target:"_blank",rel:"noopener"},t):t)]),r("div.refresh",{config:function(e,t){if(!t){var n=$(".insight-stale");n.length&&($(e).html(n.show()),lichess.refreshInsightForm())}}})])};function O(e){return r("a",{key:e.id,href:`/${e.id}/${e.color}`},[r("span.mini-board.is2d",{"data-state":`${e.fen},${e.color},${e.lastMove}`,config(e,t){t||lichess.miniBoard.init(e)}}),r("span.vstext",[r("span.vstext__pl",[e.user1.name,r("br"),e.user1.title?e.user1.title+" ":"",e.user1.rating]),r("span.vstext__op",[e.user2.name,r("br"),e.user2.rating,e.user2.title?" "+e.user2.title:""])])])}var E=function(e){if(e.vm.answer)return r("div.game-sample.box",[r("div.top","Some of the games used to generate this insight"),r("div.boards",e.vm.answer.games.map(O))])};var T=function(e,t){var n=null;return function(r){var i=t(r);return n===i?{subtree:"retain"}:(n=i,e(r))}}((function(e){return e.vm.broken?r("div.broken",[r("i[data-icon=j]"),"Insights are unavailable.",r("br"),"Please try again later."]):e.vm.answer?r("div",[g(e),w(e),E(e)]):void 0}),(function(e){var t=e.vm.answer?e.vm.answer.question:null;return t?e.makeUrl(t.dimension,t.metric,t.filters):e.vm.broken})),S=function(e){return r("div",{class:e.vm.loading?"loading":"ready"},[r("div.left-side",[C(e),r("div.panel-tabs",[r('a[data-panel="preset"]',{class:"tab preset"+("preset"===e.vm.panel?" active":""),onclick:function(){e.setPanel("preset")}},"Presets"),r('a[data-panel="filter"]',{class:"tab filter"+("filter"===e.vm.panel?" active":""),onclick:function(){e.setPanel("filter")}},"Filters"),Object.keys(e.vm.filters).length?r("a.clear",{title:"Clear all filters","data-icon":"L",onclick:e.clearFilters},"CLEAR"):null]),"filter"===e.vm.panel?u(e):null,"preset"===e.vm.panel?s(e):null,x(e)]),r("header",[a(e),r("h2",{class:"text","data-icon":"7"},"Chess Insights")]),r("div.insight__main.box",T(e))])};return function(e,t){var n=new o(t,e);return r.module(e,{controller:function(){return n},view:S}),n}}();
