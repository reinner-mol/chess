!function(){"use strict";var t,e,n=(function(t){!function(){function e(t,n){if(!(this instanceof e))return new e(t,n);if(!t||"TABLE"!==t.tagName)throw new Error("Element must be a table");this.init(t,n||{})}var n=[],r=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,void 0),e},o=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},s=function(t,e){return(t=t.trim().toLowerCase())===(e=e.trim().toLowerCase())?0:t<e?1:-1},a=function(t,e){return[].slice.call(t).find((function(t){return t.getAttribute("data-sort-column-key")===e}))},i=function(t,e){return function(n,r){var o=t(n.td,r.td);return 0===o?e?r.index-n.index:n.index-r.index:o}};e.extend=function(t,e,r){if("function"!=typeof e||"function"!=typeof r)throw new Error("Pattern and sort must be a function");n.push({name:t,pattern:e,sort:r})},e.prototype={init:function(t,e){var n,r,o,s,a=this;if(a.table=t,a.thead=!1,a.options=e,t.rows&&t.rows.length>0)if(t.tHead&&t.tHead.rows.length>0){for(o=0;o<t.tHead.rows.length;o++)if("thead"===t.tHead.rows[o].getAttribute("data-sort-method")){n=t.tHead.rows[o];break}n||(n=t.tHead.rows[t.tHead.rows.length-1]),a.thead=!0}else n=t.rows[0];if(n){var i=function(){a.current&&a.current!==this&&a.current.removeAttribute("aria-sort"),a.current=this,a.sortTable(this)};for(o=0;o<n.cells.length;o++)(s=n.cells[o]).setAttribute("role","columnheader"),"none"!==s.getAttribute("data-sort-method")&&(s.tabindex=0,s.addEventListener("click",i,!1),null!==s.getAttribute("data-sort-default")&&(r=s));r&&(a.current=r,a.sortTable(r))}},sortTable:function(t,e){var c=this,d=t.getAttribute("data-sort-column-key"),l=t.cellIndex,u=s,h="",f=[],b=c.thead?0:1,p=t.getAttribute("data-sort-method"),m=t.getAttribute("aria-sort");if(c.table.dispatchEvent(r("beforeSort")),e||(m="ascending"===m?"descending":"descending"===m?"ascending":c.options.descending?"descending":"ascending",t.setAttribute("aria-sort",m)),!(c.table.rows.length<2)){if(!p){for(;f.length<3&&b<c.table.tBodies[0].rows.length;)(h=(h=(E=d?a(c.table.tBodies[0].rows[b].cells,d):c.table.tBodies[0].rows[b].cells[l])?o(E):"").trim()).length>0&&f.push(h),b++;if(!f)return}for(b=0;b<n.length;b++)if(h=n[b],p){if(h.name===p){u=h.sort;break}}else if(f.every(h.pattern)){u=h.sort;break}for(c.col=l,b=0;b<c.table.tBodies.length;b++){var g,w=[],v={},x=0,A=0;if(!(c.table.tBodies[b].rows.length<2)){for(g=0;g<c.table.tBodies[b].rows.length;g++){var E;"none"===(h=c.table.tBodies[b].rows[g]).getAttribute("data-sort-method")?v[x]=h:(E=d?a(h.cells,d):h.cells[c.col],w.push({tr:h,td:E?o(E):"",index:x})),x++}for("descending"===m?w.sort(i(u,!0)):(w.sort(i(u,!1)),w.reverse()),g=0;g<x;g++)v[g]?(h=v[g],A++):h=w[g-A].tr,c.table.tBodies[b].appendChild(h)}}c.table.dispatchEvent(r("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},t.exports?t.exports=e:window.Tablesort=e}()}(e={path:t,exports:{},require:function(t,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==n&&e.path)}},e.exports),e.exports);const r={Accept:"application/vnd.lichess.v5+json"},o={cache:"no-cache",credentials:"same-origin"},s={"X-Requested-With":"XMLHttpRequest"},a=(t,e={})=>fetch(t,Object.assign(Object.assign(Object.assign({},o),{headers:Object.assign({},s)}),e)),i=new Map,c=(t,e={})=>{var n;return i.has(t)||i.set(t,(n=((t,e={})=>{const n=(e=e||{}).sameDomain?"":document.body.getAttribute("data-asset-url"),r=e.version||document.body.getAttribute("data-asset-version");return n+"/assets"+(e.noVersion?"":"/_"+r)+"/"+t})(t,e),new Promise(((t,e)=>{const r=document.body.getAttribute("data-nonce"),o=document.createElement("script");r&&o.setAttribute("nonce",r),o.onload=t,o.onerror=e,o.src=n,document.head.append(o)})))),i.get(t)};const d=t=>t.replace(/[^\-?0-9.]/g,""),l=(t,e)=>(t=parseFloat(t),e=parseFloat(e),(t=isNaN(t)?0:t)-(e=isNaN(e)?0:e));lichess.load.then((()=>{$("table.sortable").each((function(){n(this,{descending:!0})})),$(".name-regen").on("click",(function(){return((t,e={})=>a(t,e).then((t=>{if(t.ok)return t.text();throw t.statusText})))(this.href).then((t=>$("#form3-create-username").val(t))),!1})),$("#form3-teachers").each((function(){const t=this;c("vendor/textcomplete.min.js").then((()=>{const e=new window.Textcomplete(new window.Textcomplete.editors.Textarea(t),{dropdown:{maxCount:10,placement:"bottom"}});e.register([{id:"teacher",match:/(^|\s)(.+)$/,index:2,search(e,n){e.length<2?n([]):((t,e={})=>fetch(t,Object.assign(Object.assign(Object.assign({},o),{headers:Object.assign(Object.assign({},r),s)}),e)).then((t=>{if(t.ok)return t.json();throw t.statusText})))(((t,e)=>{const n=new URLSearchParams;for(const t of Object.keys(e))void 0!==e[t]&&n.append(t,e[t]);const r=n.toString();return r?`${t}?${r}`:t})("/player/autocomplete",{object:1,teacher:1,term:e})).then((e=>{const r=t.value.split("\n").slice(0,-1);n(e.result.filter((t=>!r.includes(t.id))))}),(t=>n([])))},template:t=>'<span class="ulpt user-link'+(t.online?" online":"")+'" href="/@/'+t.name+'"><i class="line'+(t.patron?" patron":"")+'"></i>'+(t.title?'<span class="utitle">'+t.title+"</span>&nbsp;":"")+t.name+"</span>",replace:t=>"$1"+t.name+"\n"}]),e.on("rendered",(function(){e.dropdown.items.length&&e.dropdown.items[0].activate()}))}))})),n.extend("number",(t=>t.match(/^[-+]?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/)),((t,e)=>l(d(e),d(t))))}))}();
