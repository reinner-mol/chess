var teamStart=function(){"use strict";const t=t=>{let e=t;return function(t){return(t=>void 0!==t)(t)&&(e=t),e}},e={Accept:"application/vnd.lichess.v5+json"},n={cache:"no-cache",credentials:"same-origin"},o={"X-Requested-With":"XMLHttpRequest"},s=(t,s={})=>fetch(t,Object.assign(Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign({},e),o)}),s)).then((t=>{if(t.ok)return t.json();throw t.statusText})),a=(t,e={})=>r(t,e).then((t=>{if(t.ok)return t.text();throw t.statusText})),r=(t,e={})=>fetch(t,Object.assign(Object.assign(Object.assign({},n),{headers:Object.assign({},o)}),e)),i=t=>{const e=new FormData;for(const n of Object.keys(t))e.append(n,t[n]);return e};const l={createElement:function(t,e){return document.createElement(t,e)},createElementNS:function(t,e,n){return document.createElementNS(t,e,n)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,n){t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return 1===t.nodeType},isText:function(t){return 3===t.nodeType},isComment:function(t){return 8===t.nodeType}};function c(t,e,n,o,s){return{sel:t,data:e,children:n,text:o,elm:s,key:void 0===e?void 0:e.key}}const u=Array.isArray;function d(t){return"string"==typeof t||"number"==typeof t}function h(t){return void 0===t}function m(t){return void 0!==t}const p=c("",{},[],void 0,void 0);function f(t,e){var n,o;const s=t.key===e.key,a=(null===(n=t.data)||void 0===n?void 0:n.is)===(null===(o=e.data)||void 0===o?void 0:o.is);return t.sel===e.sel&&s&&a}function g(t,e,n){var o;const s={};for(let a=e;a<=n;++a){const e=null===(o=t[a])||void 0===o?void 0:o.key;void 0!==e&&(s[e]=a)}return s}const v=["create","update","remove","destroy","pre","post"];function b(t,e){let n,o;const s={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},a=void 0!==e?e:l;for(n=0;n<v.length;++n)for(s[v[n]]=[],o=0;o<t.length;++o){const e=t[o][v[n]];void 0!==e&&s[v[n]].push(e)}function r(t){const e=t.id?"#"+t.id:"",n=t.className?"."+t.className.split(" ").join("."):"";return c(a.tagName(t).toLowerCase()+e+n,{},[],void 0,t)}function i(t,e){return function(){if(0==--e){const e=a.parentNode(t);a.removeChild(e,t)}}}function b(t,e){var n,o;let r,i=t.data;if(void 0!==i){const e=null===(n=i.hook)||void 0===n?void 0:n.init;m(e)&&(e(t),i=t.data)}const l=t.children,c=t.sel;if("!"===c)h(t.text)&&(t.text=""),t.elm=a.createComment(t.text);else if(void 0!==c){const n=c.indexOf("#"),h=c.indexOf(".",n),f=n>0?n:c.length,g=h>0?h:c.length,v=-1!==n||-1!==h?c.slice(0,Math.min(f,g)):c,k=t.elm=m(i)&&m(r=i.ns)?a.createElementNS(r,v,i):a.createElement(v,i);for(f<g&&k.setAttribute("id",c.slice(f+1,g)),h>0&&k.setAttribute("class",c.slice(g+1).replace(/\./g," ")),r=0;r<s.create.length;++r)s.create[r](p,t);if(u(l))for(r=0;r<l.length;++r){const t=l[r];null!=t&&a.appendChild(k,b(t,e))}else d(t.text)&&a.appendChild(k,a.createTextNode(t.text));const y=t.data.hook;m(y)&&(null===(o=y.create)||void 0===o||o.call(y,p,t),y.insert&&e.push(t))}else t.elm=a.createTextNode(t.text);return t.elm}function k(t,e,n,o,s,r){for(;o<=s;++o){const s=n[o];null!=s&&a.insertBefore(t,b(s,r),e)}}function y(t){var e,n;const o=t.data;if(void 0!==o){null===(n=null===(e=null==o?void 0:o.hook)||void 0===e?void 0:e.destroy)||void 0===n||n.call(e,t);for(let e=0;e<s.destroy.length;++e)s.destroy[e](t);if(void 0!==t.children)for(let e=0;e<t.children.length;++e){const n=t.children[e];null!=n&&"string"!=typeof n&&y(n)}}}function w(t,e,n,o){for(var r,l;n<=o;++n){let o,c;const u=e[n];if(null!=u)if(m(u.sel)){y(u),o=s.remove.length+1,c=i(u.elm,o);for(let t=0;t<s.remove.length;++t)s.remove[t](u,c);const t=null===(l=null===(r=null==u?void 0:u.data)||void 0===r?void 0:r.hook)||void 0===l?void 0:l.remove;m(t)?t(u,c):c()}else a.removeChild(t,u.elm)}}function x(t,e,n){var o,r,i,l,c;const u=null===(o=e.data)||void 0===o?void 0:o.hook;null===(r=null==u?void 0:u.prepatch)||void 0===r||r.call(u,t,e);const d=e.elm=t.elm,p=t.children,v=e.children;if(t!==e){if(void 0!==e.data){for(let n=0;n<s.update.length;++n)s.update[n](t,e);null===(l=null===(i=e.data.hook)||void 0===i?void 0:i.update)||void 0===l||l.call(i,t,e)}h(e.text)?m(p)&&m(v)?p!==v&&function(t,e,n,o){let s,r,i,l,c=0,u=0,d=e.length-1,m=e[0],p=e[d],v=n.length-1,y=n[0],T=n[v];for(;c<=d&&u<=v;)null==m?m=e[++c]:null==p?p=e[--d]:null==y?y=n[++u]:null==T?T=n[--v]:f(m,y)?(x(m,y,o),m=e[++c],y=n[++u]):f(p,T)?(x(p,T,o),p=e[--d],T=n[--v]):f(m,T)?(x(m,T,o),a.insertBefore(t,m.elm,a.nextSibling(p.elm)),m=e[++c],T=n[--v]):f(p,y)?(x(p,y,o),a.insertBefore(t,p.elm,m.elm),p=e[--d],y=n[++u]):(void 0===s&&(s=g(e,c,d)),r=s[y.key],h(r)?a.insertBefore(t,b(y,o),m.elm):(i=e[r],i.sel!==y.sel?a.insertBefore(t,b(y,o),m.elm):(x(i,y,o),e[r]=void 0,a.insertBefore(t,i.elm,m.elm))),y=n[++u]);(c<=d||u<=v)&&(c>d?(l=null==n[v+1]?null:n[v+1].elm,k(t,l,n,u,v,o)):w(t,e,c,d))}(d,p,v,n):m(v)?(m(t.text)&&a.setTextContent(d,""),k(d,null,v,0,v.length-1,n)):m(p)?w(d,p,0,p.length-1):m(t.text)&&a.setTextContent(d,""):t.text!==e.text&&(m(p)&&w(d,p,0,p.length-1),a.setTextContent(d,e.text)),null===(c=null==u?void 0:u.postpatch)||void 0===c||c.call(u,t,e)}}return function(t,e){let n,o,i;const l=[];for(n=0;n<s.pre.length;++n)s.pre[n]();for(function(t){return void 0!==t.sel}(t)||(t=r(t)),f(t,e)?x(t,e,l):(o=t.elm,i=a.parentNode(o),b(e,l),null!==i&&(a.insertBefore(i,e.elm,a.nextSibling(o)),w(i,[t],0,0))),n=0;n<l.length;++n)l[n].data.hook.insert(l[n]);for(n=0;n<s.post.length;++n)s.post[n]();return e}}function k(t,e,n){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==e)for(let t=0;t<e.length;++t){const n=e[t].data;void 0!==n&&k(n,e[t].children,e[t].sel)}}function y(t,e,n){let o,s,a,r={};if(void 0!==n?(null!==e&&(r=e),u(n)?o=n:d(n)?s=n:n&&n.sel&&(o=[n])):null!=e&&(u(e)?o=e:d(e)?s=e:e&&e.sel?o=[e]:r=e),void 0!==o)for(a=0;a<o.length;++a)d(o[a])&&(o[a]=c(void 0,void 0,void 0,o[a],void 0));return"s"!==t[0]||"v"!==t[1]||"g"!==t[2]||3!==t.length&&"."!==t[3]&&"#"!==t[3]||k(r,o,t),c(t,r,o,s,void 0)}function w(t,e){t.data.fn=e.data.fn,t.data.args=e.data.args,e.data=t.data,e.children=t.children,e.text=t.text,e.elm=t.elm}function x(t){const e=t.data;w(e.fn(...e.args),t)}function T(t,e){let n;const o=t.data,s=e.data,a=o.args,r=s.args;if(o.fn===s.fn&&a.length===r.length){for(n=0;n<r.length;++n)if(a[n]!==r[n])return void w(s.fn(...r),e);w(t,e)}else w(s.fn(...r),e)}function C(t,e){let n;const o=e.elm;let s=t.data.attrs,a=e.data.attrs;if((s||a)&&s!==a){for(n in s=s||{},a=a||{},a){const t=a[n];s[n]!==t&&(!0===t?o.setAttribute(n,""):!1===t?o.removeAttribute(n):120!==n.charCodeAt(0)?o.setAttribute(n,t):58===n.charCodeAt(3)?o.setAttributeNS("http://www.w3.org/XML/1998/namespace",n,t):58===n.charCodeAt(5)?o.setAttributeNS("http://www.w3.org/1999/xlink",n,t):o.setAttribute(n,t))}for(n in s)n in a||o.removeAttribute(n)}}const E={create:C,update:C};function j(t,e){let n,o;const s=e.elm;let a=t.data.class,r=e.data.class;if((a||r)&&a!==r){for(o in a=a||{},r=r||{},a)a[o]&&!Object.prototype.hasOwnProperty.call(r,o)&&s.classList.remove(o);for(o in r)n=r[o],n!==a[o]&&s.classList[n?"add":"remove"](o)}}const N={create:j,update:j};function _(t,e){const n=t.substring(0,14);return y("a",{class:{"user-link":!0,ulpt:!0},attrs:{href:"/@/"+t}},e&&"BOT"!=e?[y("span.utitle",e),n]:[n])}function L(t,e){return{insert(n){n.elm.addEventListener(t,e)}}}const O={start:["hi/Hello","gl/Good luck","hf/Have fun!","u2/You too!"].map(I),end:["gg/Good game","wp/Well played","ty/Thank you","gtg/I've got to go","bye/Bye!"].map(I)};function I(t){const e=t.split("/");return{key:e[0],text:e[1]}}const S=t=>a(A(t)),A=t=>`/${t}/note`;function B(t){let e=t.text;const n=function(t,e,n=!1){let o,s=0;return function(...a){const r=this;o&&clearTimeout(o),o=void 0;const i=performance.now()-s;s=performance.now(),n&&i>e?t.apply(r,a):o=setTimeout((()=>{o=void 0,t.apply(r,a)}),e)}}((()=>{((t,e)=>{s(A(t),{method:"post",body:i({text:e})})})(t.id,e||"")}),1e3);return{id:t.id,trans:t.trans,text:()=>e,fetch(){S(t.id).then((n=>{e=n||"",t.redraw()}))},post(t){e=t,n()}}}function R(t){const e=t.text();return null==e?y("div.loading",{hook:{insert:t.fetch}}):y("textarea",{attrs:{placeholder:t.trans("typePrivateNotesHere")},hook:{insert(n){const o=$(n.elm);o.val(e).on("change keyup paste",(()=>t.post(o.val())))}}})}let q=!1;function H(t){let e,n=!1;const o=()=>{e=void 0,n=!1,t.redraw()};return{loading:()=>n,data:()=>e,reasons:t.reasons,permissions:()=>t.permissions,open:o=>{const a=o.querySelector("a.user-link"),r=o.querySelector("t").innerText,i=a.href.split("/")[4];t.permissions.timeout?(n=!0,(t=>s("/mod/chat-user/"+t))(i).then((o=>{e=Object.assign(Object.assign({},o),{text:r}),n=!1,t.redraw()}))):e={id:i.toLowerCase(),username:i,text:r},t.redraw()},close:o,timeout(n,s){e&&lichess.pubsub.emit("socket.send","timeout",{userId:e.id,reason:n.key,text:s}),o(),t.redraw()}}}const M=()=>y("i.mod",{attrs:{"data-icon":""}});function G(e,n){const o=e.data;o.domVersion=1;const s={instance:void 0,loaded:!1,enabled:t(!!o.palantir)},a=["discussion"];e.noteId&&a.push("note"),e.plugin&&a.push(e.plugin.tab.key);const r=lichess.storage.make("chat.tab"),i=r.get();let l;const c={tab:a.find((t=>t===i))||a[0],enabled:e.alwaysEnabled||!lichess.storage.get("nochat"),placeholderKey:"talkInChat",loading:!1,timeout:e.timeout,writeable:e.writeable};a.length>1&&"discussion"===c.tab&&lichess.storage.get("nochat")&&(c.tab=a[1]);const u=t=>!!(t=t.trim())&&(!("You too!"==t&&!o.lines.some((t=>t.u!=o.userId)))&&(t.length>140?(alert("Max length: 140 chars. "+t.length+" chars used."),!1):(lichess.pubsub.emit("socket.send","talk",t),!0))),d=lichess.trans(e.i18n);function h(){(e.permissions.timeout||e.permissions.local)&&(l=H({reasons:e.timeoutReasons||[{key:"other",name:"Inappropriate behavior"}],permissions:e.permissions,redraw:n}),e.loadCss("chat.mod"))}h();const m=e.noteId?B({id:e.noteId,text:e.noteText,trans:d,redraw:n}):void 0,p=function(t){let e=t.initialGroup,n=[];return{group:()=>e,said:()=>n,setGroup(o){o!==e&&(e=o,o||(n=[]),t.redraw())},post(o){e&&O[e]&&(n.includes(o.key)||t.post(o.text)&&n.push(o.key))}}}({initialGroup:e.preset,post:u,redraw:n}),f=[["socket.in.message",t=>{o.lines.push(t);const e=o.lines.length;e>200&&(o.lines.splice(0,e-200+50),o.domVersion++),n()}],["socket.in.chat_timeout",t=>{let e=!1;o.lines.forEach((n=>{n.u&&n.u.toLowerCase()==t&&(n.d=!0,e=!0)})),t==o.userId&&(c.timeout=e=!0),e&&(o.domVersion++,n())}],["socket.in.chat_reinstate",t=>{t==o.userId&&(c.timeout=!1,n())}],["chat.writeable",t=>{c.writeable=t,n()}],["chat.permissions",t=>{let o;for(o in t)e.permissions[o]=t[o];h(),n()}],["palantir.toggle",s.enabled]];f.forEach((([t,e])=>lichess.pubsub.on(t,e)));const g=()=>lichess.pubsub.emit("chat.enabled",c.enabled);return g(),{data:o,opts:e,vm:c,allTabs:a,setTab(t){c.tab=t,r.set(t),"discussion"===t&&lichess.requestIdleCallback((()=>$(".mchat__say").each((function(){this.focus()}))),500),n()},moderation:()=>l,note:m,preset:p,post:u,trans:d,plugin:e.plugin,setEnabled(t){c.enabled=t,g(),t?lichess.storage.remove("nochat"):lichess.storage.set("nochat","1"),n()},redraw:n,palantir:s,destroy:()=>{f.forEach((([t,e])=>lichess.pubsub.off(t,e)))}}}const P=/(^|[^\w@#/])@([a-z0-9][a-z0-9_-]{0,28}[a-z0-9])/gi;function V(t,e,n){return t.includes("&quot;")?t:`<a target="_blank" rel="noopener nofollow noreferrer" href="${t.startsWith("/")||t.includes("://")?t:"//"+t}"${n?` class="${n}"`:""}>${e||t}</a>`}const z=/\b\b(?:https?:\/\/)?(lichess\.org\/[-–—\w+&'@#\/%?=()~|!:,.;]+[\w+&@#\/%=~|])/gi,F=/^[a-h][2-7]$/,K=/\b(\d+)\s*(\.+)\s*(?:[o0-]+[o0]|[NBRQKP\u2654\u2655\u2656\u2657\u2658\u2659]?[a-h]?[1-8]?[x@]?[a-z][1-8](?:=[NBRQK\u2654\u2655\u2656\u2657\u2658\u2659])?)\+?#?[!\?=]{0,5}/gi;function W(t,e,n){if(e<1||e>200)return t;return'<a class="jump" data-ply="'+(2*e-(n.length>1?0:1))+'">'+t+"</a>"}function X(t,e,n){return n.match(F)?t:function(t,e,n){return e+V("/@/"+n,"@"+n)}(0,e,n)}function D(t,e){const n=lichess.escapeHtml(t),o=n.replace(P,X).replace(z,V);return e&&o===n?o.replace(K,W):o}const Q=()=>"1"==lichess.storage.get("chat-spam"),Y=new RegExp(["xcamweb.com","(^|[^i])chess-bot","chess-cheat","coolteenbitch","letcafa.webcam","tinyurl.com/","wooga.info/","bit.ly/","wbt.link/","eb.by/","001.rs/","shr.name/","u.to/",".3-a.net",".ssl443.org",".ns02.us",".myftp.info",".flinkup.com",".serveusers.com","badoogirls.com","hide.su","wyon.de","sexdatingcz.club","qps.ru","tiny.cc/"].map((t=>t.replace(/\./g,"\\.").replace(/\//g,"\\/"))).join("|")),J=t=>!!t.match(Y),U=/follow me|join my team/i,Z=t=>!!t.match(U),tt=/lichess\.org\/team\//i,et=/^\/[wW](?:hisper)?\s/;function nt(t){if(!t.vm.enabled)return[];const e=e=>{const n=e.elm;if(t.data.lines.length>5){(0===n.scrollTop||n.scrollTop>n.scrollHeight-n.clientHeight-100)&&(n.scrollTop=999999,setTimeout((t=>n.scrollTop=999999),300))}},n=!!t.moderation(),o=[y("ol.mchat__messages.chat-v-"+t.data.domVersion,{attrs:{role:"log","aria-live":"polite","aria-atomic":"false"},hook:{insert(o){const a=$(o.elm).on("click","a.jump",(t=>{lichess.pubsub.emit("jump",t.target.getAttribute("data-ply"))}));n?a.on("click",".mod",(e=>{var n;return null===(n=t.moderation())||void 0===n?void 0:n.open(e.target.parentNode)})):a.on("click",".flag",(e=>function(t,e){const n=e.querySelector("a.user-link"),o=e.querySelector("t").innerText;n&&confirm(`Report "${o}" to moderators?`)&&((t,e,n)=>{s("/report/flag",{method:"post",body:i({username:e,resource:t,text:n})})})(t.data.resourceId,n.href.split("/")[4],o)}(t,e.target.parentNode))),e(o)},postpatch:(t,n)=>e(n)}},rt(t).map((e=>function(t,e){const n=function(t,e){if(n=t,/(\n|(@|#|\.)\w{2,})/.test(n)){const n=function(t){return(e,n)=>{n.data.lichessChat!==e.data.lichessChat&&(n.elm.innerHTML=D(n.data.lichessChat,t))}}(e);return y("t",{lichessChat:t,hook:{create:n,update:n}})}var n;return y("t",t)}(e.t,t.opts.parseMoves);if("lichess"===e.u)return y("li.system",n);if(e.c)return y("li",[y("span.color","["+e.c+"]"),n]);const o=(s="a",a=e.u,r=_,i=[e.u,e.title],void 0===i&&(i=r,r=a,a=void 0),y(s,{key:a,hook:{init:x,prepatch:T},fn:r,args:i}));var s,a,r,i;return y("li",t.moderation()?[e.u?M():null,o," ",n]:[t.data.userId&&e.u&&t.data.userId!=e.u?y("i.flag",{attrs:{"data-icon":"!",title:"Report"}}):null,o," ",n])}(t,e)))),ot(t)],a=function(t){const e=t.group();if(!e)return;const n=O[e],o=t.said();return n&&o.length<2?y("div.mchat__presets",n.map((e=>{const n=o.includes(e.key);return y("span",{class:{disabled:n},attrs:{title:e.text,disabled:n},hook:L("click",(()=>{!n&&t.post(e)}))},e.key)}))):void 0}(t.preset);return a&&o.push(a),o}function ot(t){if(!t.vm.writeable)return;if(t.data.loginRequired&&!t.data.userId||t.data.restricted)return y("input.mchat__say",{attrs:{placeholder:t.trans("loginToChat"),disabled:!0}});let e;return e=t.vm.timeout?t.trans("youHaveBeenTimedOut"):t.opts.blind?"Chat":t.trans.noarg(t.vm.placeholderKey),y("input.mchat__say",{attrs:{placeholder:e,autocomplete:"off",maxlength:140,disabled:t.vm.timeout||!t.vm.writeable,"aria-label":"Chat input"},hook:{insert(e){at(t,e.elm)}}})}let st;const at=(t,e)=>{const n=lichess.tempStorage.make("chat.input"),o=n.get();o&&(e.value=o,e.focus(),!t.opts.public&&o.match(et)&&e.classList.add("whisper")),e.addEventListener("keydown",(e=>{"Enter"===e.key&&setTimeout((()=>{const o=e.target,s=o.value,r=t.opts.public;""===s?$(".keyboard-move input").each((function(){this.focus()})):(t.opts.kobold||(t=>{if(Q())return;const e=J(t);e&&a(`/jslog/${window.location.href.substr(-12)}?n=spam`,{method:"post"}),(e||Z(t))&&lichess.storage.set("chat-spam","1")})(s),r&&(t=>!!t.match(tt))(s)?alert("Please don't advertise teams in the chat."):t.post(s),o.value="",n.remove(),r||o.classList.remove("whisper"))}))})),e.addEventListener("input",(e=>setTimeout((()=>{const o=e.target,s=o.value;o.removeAttribute("placeholder"),t.opts.public||o.classList.toggle("whisper",!!s.match(et)),n.set(s)})))),window.Mousetrap.bind("c",(()=>e.focus()));const s=["touchstart","mousedown"];st&&s.forEach((t=>document.body.removeEventListener(t,st,{capture:!0}))),st=t=>{t.shiftKey||2===t.buttons||2===t.button||e.blur()},e.onfocus=()=>s.forEach((t=>document.body.addEventListener(t,st,{passive:!0,capture:!0}))),e.onblur=()=>s.forEach((t=>document.body.removeEventListener(t,st,{capture:!0})))};function rt(t){const e=[];let n;return t.data.lines.forEach((o=>{var s,a,r;o.d||n&&(r=o,(a=n).d&&r.d&&a.u===r.u)||o.r&&(o.u||"").toLowerCase()!=t.data.userId||(s=o.t,(J(s)||Z(s))&&!Q())||e.push(o),n=o})),e}function it(t){const e=t.moderation();return y("section.mchat"+(t.opts.alwaysEnabled?"":".mchat-optional"),{class:{"mchat-mod":!!e},hook:{destroy:t.destroy}},function(t){if(!t)return;if(t.loading())return[y("div.loading")];const e=t.data();if(!e)return;const n=t.permissions(),o=e.history?y("div.infos.block",[(s=e.games||0,!1===q&&(q=window.Intl&&Intl.NumberFormat?new Intl.NumberFormat:null),(null===q?""+s:q.format(s))+" games"),e.troll?"TROLL":void 0,e.engine?"ENGINE":void 0,e.booster?"BOOSTER":void 0].map((t=>t&&y("span",t))).concat([y("a",{attrs:{href:"/@/"+e.username+"?mod"}},"profile")]).concat(n.shadowban?[y("a",{attrs:{href:"/mod/"+e.username+"/communication"}},"coms")]:[])):void 0;var s;const a=n.timeout?y("div.timeout.block",[y("strong","Timeout 15 minutes for"),...t.reasons.map((n=>y("a.text",{attrs:{"data-icon":"p"},hook:L("click",(()=>t.timeout(n,e.text)))},n.name)))]):y("div.timeout.block",[y("strong","Moderation"),y("a.text",{attrs:{"data-icon":"p"},hook:L("click",(()=>t.timeout(t.reasons[0],e.text)))},"Timeout 15 minutes")]),r=e.history?y("div.history.block",[y("strong","Timeout history"),y("table",y("tbody.slist",{hook:{insert(){lichess.contentLoaded()}}},e.history.map((function(t){return y("tr",[y("td.reason",t.reason),y("td.mod",t.mod),y("td",y("time.timeago",{attrs:{datetime:t.date}}))])}))))]):void 0;return[y("div.top",{key:"mod-"+e.id},[y("span.text",{attrs:{"data-icon":""}},[_(e.username)]),y("a",{attrs:{"data-icon":"L"},hook:L("click",t.close)})]),y("div.mchat__content.moderation",[y("i.line-text.block",['"',e.text,'"']),o,a,r])]}(e)||function(t){const e=t.vm.tab;return[y("div.mchat__tabs.nb_"+t.allTabs.length,[...t.allTabs.map((n=>function(t,e,n){return y("div.mchat__tab."+e,{class:{"mchat__tab-active":e===n},hook:L("click",(()=>t.setTab(e)))},function(t,e){return"discussion"===e?[y("span",t.data.name),t.opts.alwaysEnabled?void 0:y("input",{attrs:{type:"checkbox",title:t.trans.noarg("toggleTheChat"),checked:t.vm.enabled},hook:L("change",(e=>{t.setEnabled(e.target.checked)}))})]:"note"===e?[y("span",t.trans.noarg("notes"))]:t.plugin&&e===t.plugin.tab.key?[y("span",t.plugin.tab.name)]:[]}(t,e))}(t,n,e))),lt(t)]),y("div.mchat__content."+e,"note"===e&&t.note?[R(t.note)]:t.plugin&&e===t.plugin.tab.key?[t.plugin.view()]:nt(t))]}(t))}function lt(t){const e=t.palantir;if(e.enabled())return e.instance?e.instance.render(y):y("div.mchat__tab.palantir.palantir-slot",{attrs:{"data-icon":"",title:"Voice chat"},hook:L("click",(()=>{e.loaded||(e.loaded=!0,lichess.loadScript("javascripts/vendor/peerjs.min.js").then((()=>{lichess.loadModule("palantir").then((()=>{e.instance=window.Palantir.palantir({uid:t.data.userId,redraw:t.redraw}),t.redraw()}))})))}))})}return window.LichessChat=function(t,e){const n=b([N,E]),o=G(e,(function(){a=n(a,it(o))})),s=it(o);t.innerHTML="";let a=n(t,s);return o},function(t){lichess.socket=new lichess.StrongSocket("/team/"+t.id,t.socketVersion),t.chat&&lichess.makeChat(t.chat),$("#team-subscribe").on("change",(function(){$(this).parents("form").each((function(){(t=>{const e=t.getAttribute("action");e?a(e,{method:t.method,body:new FormData(t)}):Promise.reject(`Form has no action: ${t}`)})(this)}))}))}}();
